<!-- Thông tin số tiền -->
<div class="container mt-2">
    <div class="row g-2">
        <div class="col-lg-3 col-sm-6">
            <div class="p-3 rounded-4" style="background-color: #97BE5A;">
                <div class="row">
                    <div class="total-money col-8 fs-5 fw-bold text-light">9.100.000đ</div>
                    <div class="col-4">
                        <div class="change-percent-total d-flex align-items-center justify-content-center rounded-3 "
                            style="background-color: #F9F9E0;">
                            +2.5%
                        </div>
                    </div>
                </div>
                <div class="fs-6 mt-2 text-light">Tổng số tiền</div>
            </div>
        </div>
        <div class="col-lg-3 col-sm-6">
            <div class="p-3 rounded-4" style="background-color: #01BEFE;">
                <div class="row">
                    <div class="plan-money col-8 fs-5 fw-bold text-light">2.100.000 ₫</div>
                    <div class="col-4">
                        <div class="change-percent-plan d-flex align-items-center justify-content-center rounded-3"
                            style="background-color: #64f2f4;">
                            +1.8%
                        </div>
                    </div>
                </div>
                <div class="fs-6 mt-2 text-light">Tiền trong kế hoạch</div>
            </div>
        </div>
        <div class="col-lg-5">
            <div class="mb-2 p-2 rounded-4" style="background-color: #FF684D;">
                <div class="d-flex p-1">
                    <div class="money-after-loan fs-5 fw-bold me-4 text-light"></div>
                    <div class="row">
                        <div class="d-flex flex-column ms-5 text-light">
                            <span>Khoản cần trả</span>
                            <span>Khoản cần thu</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="d-flex flex-column ms-5">
                            <span class="need-to-pay fw-bold text-light">1.200.000đ</span>
                            <span class="need-to-receive fw-bold text-light">3.700.000đ</span>
                        </div>
                    </div>

                </div>
                <div class="fs-6 text-light ms-1">Số tiền sau vay nợ</div>
            </div>
        </div>
        <div class="col-lg-1 col-sm-12">
            <button type="button"
                class="btn btn-primary p-2 rounded-4 d-flex flex-column justify-content-center align-items-center w-100"
                data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                <i class="fa fa-solid fa-money-from-bracket fa-lg mt-3" style="color: #ffffff;"></i>
                <div class="text-wrap mt-3 text-light text-center">Phân bổ tiền vào</div>
            </button>
        </div>
    </div>
</div>

<!-- Modal phân bổ tiền  -->
<div class="modal fade allocate-money" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
    tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #3c91e6;">
                <h5 class="modal-title fw-bold text-light" id="staticBackdropLabel">Phân bổ tiền vào</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div>
                    <label for="money-input">Tiền vào:</label>
                    <input type="text" class="form-control" id="money-input">
                    <label for="allocated-to-plan">Phân bổ cho kế hoạch:</label>
                    <input type="text" class="form-control" id="allocated-to-plan">
                    <label for="allocated-to-wallet">Phân bổ cho ví:</label>
                    <input type="text" class="form-control" id="allocated-to-wallet" disabled>
                </div>
                <div class="row d-flex g-2 mt-2">
                    <div class="dropdown col-lg-3">
                        <button class="wallet btn btn-secondary dropdown-toggle  w-100" type="button" id="name-wallet"
                            data-bs-toggle="dropdown" aria-expanded="false">
                        </button>
                        <ul class="dropdown-menu dropdown-menu-wallet" aria-labelledby="name-wallet">
                        </ul>
                    </div>
                    <div class="col-lg-7">
                        <input type="text" class="form-control" id="input-wallet-option">
                    </div>
                    <div class="col-lg-2 ">
                        <button type="button" class="btn btn-primary w-100" id="send-to-wallet" disabled>Gửi</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="message-error"></div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                <button id="btn-submit-allocate-money" type="button" class="btn btn-primary">Xác nhận</button>
            </div>
        </div>
    </div>
</div>

<!-- Giao dịch chi tiêu & biểu đồ chi tiêu -->
<div class="container mt-3">
    <div class="row">
        <!-- Giao dịch -->
        <div class="col-lg-8 col-sm-12 bg-white rounded-4 p-3">

            <div class="head d-flex align-items-center mb-3">
                <div class="fw-bold me-auto fs-4">Giao dịch gần đây</div>
                <a class="load-other fw-bold p-1 me-2" href="./pages/content/Transaction.html"
                    style="text-decoration: none">
                    Sổ giao dịch
                </a>
                <div class="fw-bold p-1 bg-primary text-light rounded-3 px-1" type="button" data-bs-toggle="modal"
                    data-bs-target="#all-transaction">
                    <i class="fa-regular fa-eye" style="color: #ffffff;"></i>
                    Xem tất cả
                </div>
                <!-- <div class="fw-bold p-1 " type="button" data-bs-toggle="modal" data-bs-target="#all-transaction">
                        Xem tất cả
                    </div> -->
            </div>
            <div class="trans px-2">

            </div>
            <div class="d-flex justify-content-between">
                <span class="fs-6 mt-3">Showing <span class="fw-bold">1-4</span> from <span class="fw-bold">7</span>
                    Data</span>
            </div>

        </div>
        <!-- Biểu đồ -->
        <div class="col-lg-4 col-sm-12 p-3 rounded-4">
            <span class="fw-bold fs-4">Cấu trúc chi tiêu</span>
            <div class="mt-5" id="chart">

            </div>
        </div>
    </div>
</div>

<!-- Modal giao dịch gần đây  -->
<div class="modal fade" id="all-transaction" tabindex="-1" aria-labelledby="allTransaction" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #3c91e6;">
                <h5 class="modal-title fw-bold text-light" id="allTransaction">Xem tất cả giao dịch trong ngày</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body py-0">
                <div id="transaction-list">

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<!-- Kế hoạch | Tiền ra vào | Ví -->
<div class="container mt-4">
    <div class="row">

        <!-- Kế hoạch -->
        <div class="col-lg-5 col-sm-12 bg-white rounded-4 p-3 mb-2">
            <div class="row d-flex mb-2">
                <div class="col-6 fw-bold fs-4">Kế hoạch chi tiêu</div>
                <div class="col-3 fw-bold fs-6 d-flex align-items-center justify-content-center">Hiện tại</div>
                <div class="col-3 fw-bold fs-6 d-flex align-items-center justify-content-center">Mục tiêu</div>
            </div>
            <div class="plans-list">

            </div>
            <div class="d-flex justify-content-end">
                <a class="load-other d-flex align-items-center fw-bold me-2" href="./pages/content/SpendingPlan.html"
                    style="text-decoration: none;">
                    Kế hoạch
                </a>
                <div class="fw-bold p-1 bg-primary text-light rounded-3 px-1" type="button" data-bs-toggle="modal"
                    data-bs-target="#all-spending-plan">
                    <i class="fa-regular fa-eye" style="color: #ffffff;"></i>
                    Xem tất cả
                </div>
            </div>

        </div>

        <!-- Tiền ra | vào tháng -->
        <div class="col-lg-3 col-sm-12 d-flex flex-column justify-content-between mb-2">
            <div class="container">
                <div class="row bg-white rounded-4">
                    <div class="col-8 p-3">
                        <div class="fw-bold fs-5">Tiền vào tháng</div>
                        <div class="incomeMoney fw-bolder fs-4 text-info">200.000 ₫</div>
                        <div><span class="text-success">+5%</span> so với tháng trước</div>
                    </div>
                    <div class="col-4 p-3">
                        <img src="../../img/Line-up.png" style="object-fit: fill; width: 65px; height: 65px;">
                    </div>
                </div>
            </div>
            <div class="container mt-1">
                <div class="row bg-white rounded-4">
                    <div class="col-8 p-3">
                        <div class="fw-bold fs-5">Tiền ra tháng</div>
                        <div class="outcomeMoney fw-bolder fs-4 text-danger">300.000 ₫</div>
                        <div><span class="text-warning">-5%</span> so với tháng trước</div>
                    </div>
                    <div class="col-4 p-3">
                        <img src="../../img/Line-down.png" style="object-fit: fill; width: 65px; height: 65px;">
                    </div>
                </div>
            </div>
        </div>

        <!-- Ví -->
        <div class="col-lg-4 col-sm-12 bg-white rounded-4 p-3 mb-2">
            <div class="container d-flex justify-content-between">
                <div class="fw-bold fs-4">Ví</div>
                <div class="over-wallet mt-1" style="display: none;">
                    <i class="prev fa-regular fa-circle-left fa-xl me-2" style="cursor: pointer;"></i>
                    <i class="next fa-regular fa-circle-right fa-xl" style="cursor: pointer;"></i>
                </div>
                <i class="fa-solid fa-circle-plus fa-2xl mt-3" style="color: #0093E6; cursor: pointer;"
                    data-bs-toggle="modal" data-bs-target="#add-wallet"></i>
            </div>

            <div id="wallets-container">
                <div class="wallet-item row rounded-4 mt-2 px-1 py-3 mx-1" data-index="-1"
                    style="background-color: #538392; color: white;">
                    <div class="wallet-name col-5 fw-bold fs-6">Ví chính</div>
                    <div class="wallet-money col-5 fw-bold fs-6">1.000.000 ₫</div>
                    <div class="col-2">
                        <i class="fa-solid fa-ellipsis fa-xl" style="cursor: pointer;" id="wallet-UD"
                            data-bs-toggle="dropdown" aria-expanded="false"></i>
                        <ul class="dropdown-menu" aria-labelledby="wallet-UD">
                            <li><a id="modify-wallet-btn" href="#" class="dropdown-item" data-bs-toggle="modal"
                                    data-bs-target="#modify-wallet">Sửa</a></li>
                            <li><a href="#" class="dropdown-item" id="delete-wallet-btn" data-bs-toggle="modal"
                                    data-bs-target="#confirmDelete">Xóa</a></li>
                        </ul>
                    </div>
                </div>
                <div class="wallet-item row rounded-4 mt-2 px-1 py-3 mx-1" data-index="0"
                    style="background-color: #EF9C66; color: white;">
                    <div class="wallet-name col-5 fw-bold fs-6">Ví phụ</div>
                    <div class="wallet-money col-5 fw-bold fs-6">2.000.000 ₫</div>
                    <div class="col-2">
                        <i class="fa-solid fa-ellipsis fa-xl" style="cursor: pointer;" id="wallet-UD"
                            data-bs-toggle="dropdown" aria-expanded="false"></i>
                        <ul class="dropdown-menu" aria-labelledby="wallet-UD">
                            <li><a id="modify-wallet-btn" href="#" class="dropdown-item" data-bs-toggle="modal"
                                    data-bs-target="#modify-wallet">Sửa</a></li>
                            <li><a href="#" class="dropdown-item" id="delete-wallet-btn" data-bs-toggle="modal"
                                    data-bs-target="#confirmDelete">Xóa</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal tạo ví  -->
<div class="modal fade modal-md" id="add-wallet" tabindex="-1" aria-labelledby="addWallet" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <h5 class="modal-title fw-bold text-light" id="addWallet">Tạo ví</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body py-0">
                <form id="addWalletForm">
                    <div>
                        <label for="addWalletName">Tên ví:</label>
                        <input type="text" class="form-control" id="addWalletName" name="walletName">
                        <label for="addWalletMoney">Số tiền:</label>
                        <input type="text" class="form-control" id="addWalletMoney" name="walletMoney">

                        <label for="addWalletColor" class="form-label">Màu sắc:</label>
                        <div class="d-flex mb-1">
                            <input type="color" class="form-control form-control-color" id="addWalletColor"
                                value="#000000">
                            <input type="text" class="form-control ms-1" id="addColorCode" placeholder="#000000"
                                name="colorCode" value="#000000">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <div id="errorMessages" class="mt-3 text-danger"></div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                <button id="create-wallet-btn" type="button" class="btn btn-primary">Tạo</button>
            </div>
        </div>
    </div>
</div>


<!-- Modal sửa ví  -->
<div class="modal fade modal-md" id="modify-wallet" tabindex="-1" aria-labelledby="modifyWallet" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <h5 class="modal-title fw-bold text-light" id="modifyWallet">Sửa ví</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body py-0">
                <div>
                    <label for="modifyWalletName">Tên ví:</label>
                    <input type="text" class="form-control" id="modifyWalletName">
                    <label for="modifyWalletMoney">Số tiền:</label>
                    <input type="text" class="form-control" id="modifyWalletMoney">
                    <label for="modifyWalletColor" class="form-label">Màu sắc:</label>
                    <div class="d-flex mb-1">
                        <input type="color" class="form-control form-control-color" id="modifyWalletColor">
                        <input type="text" class="form-control ms-1" id="modifyColorCode" placeholder="#000000">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                <button id="save-modify-btn" type="button" class="btn btn-primary" data-bs-dismiss="modal">Sửa</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal kế hoạch chi tiêu  -->
<div class="modal fade" id="all-spending-plan" tabindex="-1" aria-labelledby="allSpendingPlan" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #3c91e6;">
                <h5 class="modal-title fw-bold text-light" id="allSpendingPlan">Các kế hoạch chi tiêu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body py-0">
                <div class="row" style="border-bottom: 2px solid black;">
                    <div class="col-1">
                    </div>
                    <div class="col-5 px-0 py-2">
                        <div class="fw-bold fs-5 ms-4">Kế hoạch</div>
                    </div>
                    <div class="col-3 px-0 py-2">
                        <div class="fw-bold fs-5 ms-2">Hiện tại</div>
                    </div>
                    <div class="col-3 px-0 py-2">
                        <div class="fw-bold fs-5 ms-2">Mục tiêu</div>
                    </div>
                </div>
                <div class="plans-modal">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal confirm delete-->
<div class="modal fade" id="confirmDelete" tabindex="-1" aria-labelledby="confirmDeleteModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger">
                <h5 class="modal-title text-light" id="confirmDeleteModal">Bạn có chắc chắn muốn xóa ví không?</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Không</button>
                <button type="button" class="btn btn-danger" id="confirm-delete-btn"
                    data-bs-dismiss="modal">Xóa</button>
            </div>
        </div>
    </div>
</div>



<script>
    Data = {
        "transactions": [
            {
                "category": "Ăn uống",
                "content": "Nhà hàng Phương Đông",
                "date": "6/5/2025",
                "wallet": "Ví chính",
                "amount": "50.000 ",
                "image": "/img/Icon/AnUong.png"
            },
            {
                "category": "Caffe",
                "content": "Uống cà phê",
                "date": "6/5/2025",
                "wallet": "Ví phụ",
                "amount": "30.000 ",
                "image": "/img/Icon/icon_15.png"
            },
            {
                "category": "Vui - chơi",
                "content": "Xem phim",
                "date": "7/5/2025",
                "wallet": "Ví chính",
                "amount": "100.000 ",
                "image": "/img/Icon/icon_49.png"
            },
            {
                "category": "Di chuyển",
                "content": "Đi taxi",
                "date": "7/5/2025",
                "wallet": "Ví phụ",
                "amount": "80.000 ",
                "image": "/img/Icon/icon_12.png"
            },
            {
                "category": "Mua sắm",
                "content": "Mua quần áo",
                "date": "8/5/2025",
                "wallet": "Ví chính",
                "amount": "200.000 ",
                "image": "/img/Icon/icon_100.png"
            },
            {
                "category": "Giáo dục",
                "content": "Mua sách",
                "date": "9/5/2025",
                "wallet": "Ví phụ",
                "amount": "50.000 ",
                "image": "/img/Icon/icon_113.png"
            },
            {
                "category": "Sức khỏe",
                "content": "Khám bệnh",
                "date": "10/5/2025",
                "wallet": "Ví chính",
                "amount": "300.000 ",
                "image": "/img/Icon/icon_14.png"
            }
        ],
        "plans": [
            {
                "icon": "/img/Icon/icon_29.png",
                "content": "Mua nhà",
                "durationMonth": "9",
                "durationYear": "2028",
                "present": "1.200.000.000",
                "target": "5.800.000.000"
            },
            {
                "icon": "/img/Icon/icon_13.png",
                "content": "Mua xe",
                "durationMonth": "5",
                "durationYear": "2025",
                "present": "100.000.000",
                "target": "400.000.000"
            },
            {
                "icon": "/img/Icon/icon_19.png",
                "content": "Mua máy tính",
                "durationMonth": "8",
                "durationYear": "2024",
                "present": "11.000.000",
                "target": "29.000.000"
            },
            {
                "icon": "/img/Icon/icon_41.png",
                "content": "Mua điện thoại",
                "durationMonth": "1",
                "durationYear": "2024",
                "present": "11.000.000",
                "target": "12.000.000"
            },
            {
                "icon": "/img/Icon/icon_57.png",
                "content": "Đầu tư quỹ",
                "durationMonth": "6",
                "durationYear": "2025",
                "present": "11.000.000",
                "target": "29.000.000"
            },

        ]
    };
    $(document).ready(function () {
        //Hiển thị dữ liệu
        function showModalTransaction() {
            const transactionsForModal = Data.transactions;
            let transactionRowsModal = '';
            transactionsForModal.forEach(transaction => {
                transactionRowsModal += `
                        <div class="row bm-3 px-0 py-2" style="border-bottom: 2px solid black;">
                            <div class="col-1 d-flex justify-content-center">
                                <img class="ms-2" src="${transaction.image}" style="width: 40px; height: 40px;">
                            </div>
                            <div class="col-2 mt-1">
                                <div class="fs-6">${transaction.category}</div>
                            </div>
                            <div class="col-3 mt-1">
                                <div class="fs-6">${transaction.content}</div>
                            </div>
                            <div class="col-2 mt-1">
                                <div class="fs-6">${transaction.date}</div>
                            </div>
                            <div class="col-2 mt-1">
                                <div class="fs-6 d-flex justify-content-center">${transaction.wallet}</div>
                            </div>
                            <div class="col-2 mt-1">
                                <div class="fs-6 d-flex justify-content-center text-danger">-${transaction.amount} đ</div>
                            </div>
                        </div>
                    `;
            });
            $('#transaction-list').html(`
            <div class="row" style="border-bottom: 2px solid black;">
                        <div class="col-1">
                        </div>
                        <div class="col-2 px-0 py-2">
                            <div class="fw-bold fs-5">Danh mục</div>
                        </div>
                        <div class="col-3 py-2">
                            <div class="fw-bold fs-5">Nội dung</div>
                        </div>
                        <div class="col-2 py-2">
                            <div class="fw-bold fs-5">Ngày tạo</div>
                        </div>
                        <div class="col-2 px-0 py-2">
                            <div class="fw-bold fs-5 d-flex justify-content-center">Ví</div>
                        </div>
                        <div class="col-2 px-0 py-2">
                            <div class="fw-bold fs-5 d-flex justify-content-center">Số tiền</div>
                        </div>
                    </div>
                    ${transactionRowsModal}
            `
            );
        }

        $('#all-transaction').on('shown.bs.modal', function () {
            showModalTransaction();
        });

        function loadDataTransaction() {
            const transactionsForList = Data.transactions.slice(0, 4); // Lấy 4 giao dịch đầu tiên
            let transactionRowsList = '';

            transactionsForList.forEach(transaction => {
                transactionRowsList += `
                        <div class="row mb-1 p-2 " style="border-bottom: 2px solid black;">
                            <div class="col-3">
                                <div class="fs-6 ms-1">${transaction.category}</div>
                            </div>
                            <div class="col-3">
                                <div class="fs-6">${transaction.content}</div>
                            </div>
                            <div class="col-2">
                                <div class="fs-6 ms-1">${transaction.date}</div>
                            </div>
                            <div class="col-2">
                                <div class="fs-6 d-flex justify-content-center">${transaction.wallet}</div>
                            </div>
                            <div class="col-2">
                                <div class="fs-6 d-flex justify-content-center text-danger">-${transaction.amount} đ</div>
                            </div>
                        </div>
                    `;
            });

            $('.trans').html(`
                    <div class="row mb-1 p-2" style="border-bottom: 2px solid black;">
                        <div class="col-3">
                            <div class="fw-bold fs-5">Danh mục</div>
                        </div>
                        <div class="col-3">
                            <div class="fw-bold fs-5">Nội dung</div>
                        </div>
                        <div class="col-2">
                            <div class="fw-bold fs-5">Ngày tạo</div>
                        </div>
                        <div class="col-2">
                            <div class="fw-bold fs-5 d-flex justify-content-center">Ví</div>
                        </div>
                        <div class="col-2">
                            <div class="fw-bold fs-5 d-flex justify-content-center">Số tiền</div>
                        </div>
                    </div>
                    ${transactionRowsList}
                `);
        }
        loadDataTransaction()

        function showModalPlan() {
            const plansForModal = Data.plans;
            let planRowsModal = '';
            plansForModal.forEach(plan => {
                planRowsModal += `
                        <div class="row bm-3 px-0 py-2" style="border-bottom: 2px solid black;">
                        <div class="col-1 d-flex justify-content-center">
                            <img class="" src="${plan.icon}" style="width: 40px; height: 40px;">
                        </div>
                        <div class="col-5 ">
                            <div class="fw-bold fs-6 ">${plan.content}</div>
                            <div style="color: #CFABAB;">Dự kiến đến tháng ${plan.durationMonth} năm ${plan.durationYear}</div>
                        </div>
                        <div class="col-3 d-flex align-items-center px-0">
                            <div class="fs-6 text-info fw-bold text-center">${plan.present}đ</div>
                        </div>
                        <div class="col-3 d-flex align-items-center px-0">
                            <div class="fs-6 text-danger fw-bold text-center">${plan.target}đ</div>
                        </div>
                    </div>
                    `;
            });
            $('.plans-modal').html(planRowsModal);
        }

        $('#all-spending-plan').on('shown.bs.modal', function () {
            showModalPlan();
        });

        function loadDataPlan() {
            const plansForList = Data.plans.slice(0, 3);
            let planRowsList = '';
            plansForList.forEach(plan => {
                planRowsList += `
                        <div class="row d-flex mt-2">
                <div class="col-6 d-flex align-items-center justify-content-start">
                    <div class="icon me-3">
                        <img class="" src="${plan.icon}" style="width: 40px; height: 40px;">
                    </div>
                    <div class="info">
                        <div class="fw-bold">
                            ${plan.content}
                        </div>
                        <div class="text-info fs-7">
                            Đến tháng ${plan.durationMonth} năm ${plan.durationYear}
                        </div>
                    </div>
                </div>
                <div class="col-3 text-center mt-2 fw-bold">${plan.present}đ</div>
                <div class="col-3 text-center mt-2 fw-bold">${plan.target}đ</div>
            </div>
                `;
            });
            $('.plans-list').html(planRowsList)
        }
        loadDataPlan()

        //Converts a number to a currency string formatted VND
        function formatCurrency(number) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(number).replace(/\D00$/, '');
        }

        //Converts a formatted currency string back to a number for calculations.
        function parseCurrency(currencyString) {
            // Loại bỏ các ký tự không phải là số và dấu chấm
            let numberString = currencyString.replace(/[^\d]/g, '');
            // Chuyển đổi chuỗi kết quả sang số nguyên
            let number = parseInt(numberString, 10);
            return number;
        }

        //Validate input allocated field
        function validateInput(field1, field2, field3) {
            var isValid = true;
            var errorFields = '';

            if (!$.isNumeric(field1) || parseFloat(field1) <= 0) {
                isValid = false;
                errorFields += 'Tiền vào phải là một số và lớn hơn 0.\n';
            }
            if (!$.isNumeric(field2)) {
                isValid = false;
                errorFields += 'Tiền phân bổ cho kế hoạch phải là một số .\n';
            }
            // if (!$.isNumeric(field1) || parseFloat(field1) <= 0) {
            //     isValid = false;
            //     errorFields += 'Tiền phân bổ cho ví phải là một số và lớn hơn 0.\n';
            // }
            if (!$.isNumeric(field3)) {
                isValid = false;
                errorFields += 'Tiền phân bổ cho ví phải là một số.\n';
            }
            if (parseFloat(field3) != 0) {
                isValid = false;
                errorFields += 'Bạn phải phân bổ hết tiền cho các ví.\n';
            }

            return { isValid: isValid, errorFields: errorFields };
        }

        //Đồng bộ tiền vào, tiền phân bổ kế hoạch và tiền phân bổ cho ví
        function updateAllocatedValues1() {
            const moneyInput = parseFloat($('#money-input').val()) || 0;
            const allocatedToPlan = parseFloat($('#allocated-to-plan').val()) || 0;
            const allocatedToWallet = moneyInput - allocatedToPlan;

            $('#allocated-to-wallet').val(allocatedToWallet);
        }

        $('#money-input, #allocated-to-plan').on('input', function () {
            updateAllocatedValues1();
        });

        //Đồng bộ tiền phân bổ cho ví và các ví
        function updateAllocatedValues2() {
            const allocatedToWallet = $('#allocated-to-wallet').val() || 0
            const addToWallet = parseFloat($('#input-wallet-option').val()) || 0
            const newAllocatedToWallet = allocatedToWallet - addToWallet
            if (addToWallet > allocatedToWallet) {
                alert("Vượt quá số tiền phân bổ!")
                $('#input-wallet-option').val('')
                addToWallet.focus()

            }
            else {
                $('#allocated-to-wallet').val(newAllocatedToWallet);
                $('#send-to-wallet').removeAttr('disabled')
            }
        }

        $('#input-wallet-option').on('change', function () {
            updateAllocatedValues2()
        });

        //Load total-money
        function updateTotalMoney() {
            var totalMoney = 0;
            $('#wallets-container .wallet-money').each(function () {
                var walletMoney = parseCurrency($(this).text())
                totalMoney += walletMoney;
            })
            $('.total-money').html(formatCurrency(totalMoney))
        }

        //Load loan-money
        function updateLoanMoney() {
            var moneyAfterLoan = parseCurrency($('.money-after-loan').text())
            var needToPay = parseCurrency($('.need-to-pay').text())
            var needToReceive = parseCurrency($('.need-to-receive').text())
            moneyAfterLoan = needToReceive - needToPay;
            $('.money-after-loan').html(formatCurrency(moneyAfterLoan))
        }

        //Hiển thị các ví trong modal phân bổ
        function showWalletOptions() {
            $('.dropdown-menu-wallet').empty();

            // Lấy tất cả tên ví
            $('#wallets-container .wallet-name').each(function () {
                var walletName = $(this).text().trim();
                // Create a new list item for each wallet name
                var listItem = $('<li>').append(
                    $('<button>').addClass('dropdown-item wallet-option').attr('type', 'button').text(walletName)
                );
                // Append the list item to the dropdown menu
                $('.dropdown-menu-wallet').append(listItem);
            });

            // Cài đặt tên ví đầu tiên cho dropdown button
            var firstWalletName = $('#wallets-container .wallet-name').first().text().trim();
            $('#name-wallet').text(firstWalletName);
        }

        showWalletOptions();
        updateTotalMoney()
        updateLoanMoney()

        // Event listener for dropdown item click to update the dropdown button text (modal allocated)
        $('.dropdown-menu-wallet').on('click', '.dropdown-item', function () {
            $('.dropdown-item').removeClass('active');
            $(this).addClass('active');
            $('#name-wallet').text($(this).text());
        });

        // Submit tiền cho ví
        $('#send-to-wallet').on('click', function () {
            var addToWalletSelected = parseFloat($('#input-wallet-option').val());
            var walletSelected = null;
            $('#wallets-container .wallet-item').each(function () {
                if ($(this).find('.wallet-name').text().trim() === $('#name-wallet').text().trim()) {
                    walletSelected = $(this);
                }
            });
            if (walletSelected === null) {
                return;
            }

            var moneyWalletSelected = parseCurrency(walletSelected.find('.wallet-money').text());
            var newMoneyForWalletSelected = moneyWalletSelected + addToWalletSelected;
            walletSelected.find('.wallet-money').text(formatCurrency(newMoneyForWalletSelected));

            $('#input-wallet-option').val('');
            $(this).prop('disabled', true)

        });

        //Submit modal phân bổ tiền vào
        $('#btn-submit-allocate-money').on('click', function () {
            var inputMoney = $('#money-input').val()
            var allocatedToPlan = $('#allocated-to-plan').val()
            var allocatedToWallet = $('#allocated-to-wallet').val()
            var inputWalletOption = $('.input-wallet-option').val()

            var totalMoney = parseCurrency($('.total-money').text())
            var planMoney = parseCurrency($('.plan-money').text())

            var validationResult = validateInput(inputMoney, allocatedToPlan, allocatedToWallet)

            if (validationResult.isValid) {
                var newTotalMoney = parseFloat(totalMoney) + parseFloat(allocatedToWallet);
                var newPlanMoney = parseFloat(planMoney) + parseFloat(allocatedToPlan);

                var moneyTotalChanged = ((newTotalMoney - totalMoney) / totalMoney) * 100
                var moneyTotalChangedText = (moneyTotalChanged >= 0 ? '+' : '-') + moneyTotalChanged.toFixed(2) + '%';
                var moneyPlanChanged = ((newPlanMoney - planMoney) / planMoney) * 100
                var moneyPlanChangedText = (moneyPlanChanged >= 0 ? '+' : '-') + moneyPlanChanged.toFixed(2) + '%';

                $('.change-percent-total').html(moneyTotalChangedText)
                $('.change-percent-plan').html(moneyPlanChangedText)
                $('.total-money').html(formatCurrency(newTotalMoney))
                $('.plan-money').html(formatCurrency(newPlanMoney))

                $('#money-input').val('')
                $('#allocated-to-plan').val('')
                $('#allocated-to-wallet').val('')
                $('#input-wallet-option').val('')
                updateTotalMoney()

                var incomeMoney = $(".incomeMoney").val()
                incomeMoney += inputMoney
                $(".incomeMoney").text(formatCurrency(incomeMoney))


                alert("Phân bổ thành công")
                // Hide the modal using Bootstrap's modal instance
                var modal = bootstrap.Modal.getInstance(document.getElementsByClassName('allocate-money')[0]);
                modal.hide();
            } else {
                alert(validationResult.errorFields)
            }
        });

        //Navigate page
        $(".load-other").click(function (e) {
            e.preventDefault();
            var childUrl = $(this).attr("href");
            $("#page-content", window.parent.document).load(childUrl);

            const allParentSide = $("#sidebar .side-menu.top li a");
            allParentSide.each(function () {
                //Check if satisfy the condition
                if ($(this).attr("href") === childUrl) {
                    //Remove all parent has active class
                    allParentSide.each(function () {
                        $(this).parent().removeClass("active");
                    })
                    var li = $(this).parent();
                    //Add class active for target
                    li.addClass("active")
                }
            })
        })

        // Color synchronization
        function synchronizationColor(walletColor, codeColor) {
            walletColor.on('input', function () {
                codeColor.val($(this).val());
            });

            codeColor.on('input', function () {
                if (/^#[0-9A-Fa-f]{6}$/i.test($(this).val())) {
                    walletColor.val($(this).val());
                }
            });
        }

        // Validate input field
        function validateWalletInputs(walletName, walletMoney, colorCode) {
            var isValid = true;
            var errorMessages = '';

            // Validate wallet name
            if (walletName.trim() === '') {
                isValid = false;
                errorMessages += '<p>Tên ví không được để trống.</p>';
            }

            // Validate wallet money
            if (!$.isNumeric(walletMoney) || parseFloat(walletMoney) <= 0) {
                isValid = false;
                errorMessages += '<p>Số tiền phải là một số và lớn hơn 0.</p>';
            }

            // Validate color code
            var colorCodePattern = /^#[0-9A-Fa-f]{6}$/i;
            if (!colorCodePattern.test(colorCode.trim())) {
                isValid = false;
                errorMessages += '<p>Mã màu không hợp lệ. Mã màu phải bắt đầu bằng # và gồm 6 ký tự.</p>';
            }

            return { isValid: isValid, errorMessages: errorMessages };
        }

        synchronizationColor($("#addWalletColor"), $("#addColorCode"));
        var index = 1;
        //Add wallet
        $("#create-wallet-btn").on('click', function () {
            var walletName = $("#addWalletName").val().trim();
            var walletMoney = $("#addWalletMoney").val().trim();
            var walletColor = $("#addWalletColor").val();
            var colorCode = $("#addColorCode").val().trim();

            var validationResult = validateWalletInputs(walletName, walletMoney, colorCode);

            if (validationResult.isValid) {
                var newWallet = `
                <div class="wallet-item row rounded-4 mt-2 px-1 py-3 mx-1" data-index="${index}" style="background-color: ${walletColor}; color: white;">
                    <div class="wallet-name col-5 fw-bold fs-6">${walletName}</div>
                    <div class="wallet-money col-5 fw-bold fs-6">${formatCurrency(walletMoney)}</div>
                    <div class="col-2">
                        <i class="fa-solid fa-ellipsis fa-xl" style="cursor: pointer;" id="wallet-UD"
                            data-bs-toggle="dropdown" aria-expanded="false"></i>
                        <ul class="dropdown-menu" aria-labelledby="wallet-UD">
                            <li><a id="modify-wallet-btn" href="#" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#modify-wallet"
                                    >Sửa</a></li>
                            <li><a href="#" class="dropdown-item" id="delete-wallet-btn" data-bs-toggle="modal" data-bs-target="#confirmDelete">Xóa</a></li>
                        </ul>
                    </div>
                </div>
            `;
                $('#wallets-container').append(newWallet);
                index++;

                $("#addWalletName").val('');
                $("#addWalletMoney").val('');
                $("#addWalletColor").val('#000000');
                $("#addColorCode").val('#000000');
                $('#errorMessages').html('')

                updateTotalMoney();
                showWalletOptions();

                // Lấy thể hiện modal sử dung hide
                var modal = bootstrap.Modal.getInstance(document.getElementById('add-wallet'));
                modal.hide();
                updateWalletPage()
            } else {
                $('#errorMessages').html(validationResult.errorMessages);
            }
        });

        // Edit wallet
        synchronizationColor($("#modifyWalletColor"), $("#modifyColorCode"));
        $(document).on('click', '#modify-wallet-btn', function () {
            //Lấy thông tin của ví cần sửa
            var walletItem = $(this).closest('.wallet-item');
            var walletName = walletItem.find('.wallet-name').text().trim()
            var walletMoney = walletItem.find('.wallet-money').text().trim()
            var walletColor = walletItem.css('background-color')


            //Set data cho field
            $('#modifyWalletName').val(walletName)
            $('#modifyWalletMoney').val(parseCurrency(walletMoney))
            var codeColor = rgbToHex(walletColor)
            $('#modifyWalletColor').val(codeColor)
            $('#modifyColorCode').val(codeColor)

            $('#save-modify-btn').off('click').on('click', function () {
                synchronizationColor($("#modifyWalletColor"), $("#colorCode"));
                var newWalletName = $("#modifyWalletName").val();
                var newWalletMoney = $("#modifyWalletMoney").val();
                var newColorCode = $("#modifyColorCode").val();
                var newWalletColor = $("#modifyWalletColor").val();

                var validationResult = validateWalletInputs(newWalletName, newWalletMoney, newColorCode);

                if (validationResult.isValid) {
                    walletItem.find('.wallet-name').text(newWalletName);
                    walletItem.find('.wallet-money').text(formatCurrency(newWalletMoney));
                    walletItem.css('background-color', newColorCode);

                    $('#errorMessages').html('');

                    updateTotalMoney();
                    showWalletOptions();

                    var modal = bootstrap.Modal.getInstance(document.getElementById('modify-wallet'));
                    modal.hide();
                } else {
                    $('#errorMessages').html(validationResult.errorMessages);
                }
            });


        });

        function rgbToHex(rgb) {
            // Extract the numeric values from the rgb string
            var rgbValues = rgb.match(/\d+/g);
            // Convert the extracted values to hexadecimal format
            var r = parseInt(rgbValues[0]).toString(16).padStart(2, '0');
            var g = parseInt(rgbValues[1]).toString(16).padStart(2, '0');
            var b = parseInt(rgbValues[2]).toString(16).padStart(2, '0');
            // Combine the hex values into a single string
            return `#${r}${g}${b}`;
        }

        // Delete wallet button click event
        // $(document).on('click', '#delete-wallet-btn', function () {
        //     var deleteReference = $(this)
        //     $('#confirm-delete-btn').on('click', function () {
        //         deleteReference.closest('.wallet-item').remove();
        //     })
        // })

        // Delete wallet with index
        $(document).on('click', '#delete-wallet-btn', function () {
            var indexToDelete = $(this).closest('.wallet-item').data('index')
            $('#confirm-delete-btn').on('click', function () {
                if (indexToDelete !== null) {
                    $('.wallet-item').filter(function () {
                        return $(this).data('index') === indexToDelete;
                    }).remove()
                }
                indexToDelete = null;

                updateTotalMoney();
                showWalletOptions();
                updateWalletPage()
            })

        })
    })

    //Quản lý số ví: over
    function updateWalletPage() {
        var $walletContainer = $('#wallets-container');
        var $walletItems = $walletContainer.find('.wallet-item');
        var $overWallet = $('.over-wallet');
        var itemsPerPage = 3;
        let currentIndex = 0;

        console.log('wallet item: ', $walletItems.length)

        function updateWalletDisplay() {
            $walletItems.hide();
            for (let i = currentIndex; i < currentIndex + itemsPerPage; i++) {
                $walletItems.eq(i).show();
            }
            $overWallet.toggle($walletItems.length > itemsPerPage);
        }

        $('.next').click(function () {
            if (currentIndex + itemsPerPage < $walletItems.length) {
                currentIndex += itemsPerPage;
                updateWalletDisplay();
            }
        });

        $('.prev').click(function () {
            if (currentIndex - itemsPerPage >= 0) {
                currentIndex -= itemsPerPage;
                updateWalletDisplay();
            }
        });

        updateWalletDisplay();
    }


    // Data for the donut chart
    var donutData = {
        series: [30, 8, 20, 43, 50],
        labels: ['Ăn uống', 'Di chuyển', 'Sức khỏe', 'Giáo dục', 'Khác']
    };
    // Options for the donut chart
    var donutOptions = {
        chart: {
            type: 'donut'
        },
        series: donutData.series,
        labels: donutData.labels,
        responsive: [{
            breakpoint: 480,
            options: {

                legend: {
                    position: 'bottom'
                }
            }
        }]
    };
    // Initialize the donut chart
    var donutChart = new ApexCharts(document.querySelector("#chart"), donutOptions);
    // Render the chart
    donutChart.render();


</script>